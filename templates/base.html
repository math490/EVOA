<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %} EVOA {% endblock %}</title>
    <link rel="stylesheet" href="static/styles/style.css">
    <link rel="icon" href="../static/images/EVOA logo.svg">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-sRIl4kxILFvY47J16cr9ZwB07vP4J8+LH7qKQnuqkuIAvNWLzeN8tE5YBujZqJLB" crossorigin="anonymous">
</head>
<body>
    <header>
        <!-- Navbar para telas grandes -->
        <nav class="navbar navbar-expand-lg navbar-dark bg-success d-none d-lg-flex align-items-center justify-content-between px-4">
            <div class="navbar-brand d-flex align-items-center">
                <img class="logo" src="../static/images/EVOA logo.svg" alt="Logo">
            </div>
            <div class="text-center flex-grow-1">
                <span class="navbar-text fs-3 fw-bold">EVOA</span>
                <div class="small text-light">Ecologia - Vigilância - Organização - Ação</div>
            </div>
            <div class="dropdown">
                <button class="btn btn-outline-light dropdown-toggle" type="button" id="navbarDropdown" data-bs-toggle="dropdown" aria-expanded="false">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">
                    {% if current_user.is_authenticated %}
                        <li><a class="dropdown-item" href="{{ url_for('index') }}">Início</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('trash_logs') }}">Minhas Reciclagens</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('profile') }}">Minha Conta</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('material_register') }}">Registrar Material</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('logout') }}">Sair</a></li>
                    {% else %}
                        <li><a class="dropdown-item" href="{{ url_for('login') }}">Login</a></li>
                        <li><a class="dropdown-item" href="{{ url_for('register') }}">Registrar</a></li>
                    {% endif %}
                </ul>
            </div>
        </nav>
        <!-- Navbar para telas pequenas -->
        <nav class="navbar navbar-dark bg-success d-lg-none px-3 py-2">
            <button class="btn btn-outline-light me-2" type="button" data-bs-toggle="offcanvas" data-bs-target="#sidebarMenu" aria-controls="sidebarMenu">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="mx-auto text-center">
                <div class="logo-tit">
                    <img class="logo" src="../static/images/EVOA logo.svg" alt="Logo">
                    <div class="navbar-text fs-5 fw-bold">EVOA</div>
                </div>
            </div>
        </nav>
        <!-- Sidebar para telas pequenas -->
        <div class="offcanvas offcanvas-start" tabindex="-1" id="sidebarMenu" aria-labelledby="sidebarMenuLabel">
            <div class="offcanvas-header">
                <h5 class="offcanvas-title" id="sidebarMenuLabel">Menu</h5>
                <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
            </div>
            <div class="offcanvas-body">
                <ul class="navbar-nav">
                    <li class="nav-item"><a class="nav-link" href="{{ url_for('index') }}">Início</a></li>
                    {% if current_user.is_authenticated %}
                        <li class="nav-item"><a class="nav-link" href="{{ url_for('index') }}">Início</a></li>
                        <li class="nav-item"><a class="nav-link" href="{{ url_for('trash_logs') }}">Minhas Reciclagens</a></li>
                        <li class="nav-item"><a class="nav-link" href="{{ url_for('profile') }}">Minha Conta</a></li>
                        <li class="nav-item"><a class="nav-link" href="{{ url_for('material_register') }}">Registrar Material</a></li>
                        <li class="nav-item"><a class="nav-link" href="{{ url_for('logout') }}">Sair</a></li>
                    {% else %}
                        <li class="nav-item"><a class="nav-link" href="{{ url_for('login') }}">Login</a></li>
                        <li class="nav-item"><a class="nav-link" href="{{ url_for('register') }}">Registrar</a></li>
                    {% endif %}
                </ul>
            </div>
        </div>
    </header>
    <main>
        <div aria-live="polite" aria-atomic="true" class="position-fixed bottom-0 end-0 p-3" style="z-index: 1080;">
        <div id="toast-container">
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="toast align-items-center text-white 
                            {% if category == 'error' or category == 'danger' %}bg-danger
                            {% elif category == 'warning' %}bg-warning text-dark
                            {% elif category == 'info' %}bg-info text-dark
                            {% else %}bg-success{% endif %}
                            border-0 mb-2" role="alert" aria-live="assertive" aria-atomic="true" data-bs-delay="6000">
                            <div class="d-flex">
                                <div class="toast-body">
                                    {{ message }}
                                </div>
                                <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast" aria-label="Close"></button>
                            </div>
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}
        </div>
    </div>
        {% block content %}{% endblock %}
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.8/dist/js/bootstrap.bundle.min.js" integrity="sha384-FKyoEForCGlyvwx9Hj09JcYn3nv7wiPVlz7YYwJrWVcXK/BmnVDxM+D2scQbITxI" crossorigin="anonymous"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function() {
                const form = document.getElementById('registerForm');
                const submitBtn = document.getElementById('submitBtn');
                form.addEventListener('input', function() {
                    let valid = true;
                    form.querySelectorAll('[required]').forEach(function(input) {
                        if (!input.value.trim()) valid = false;
                    });
                    submitBtn.disabled = !valid;
                });
            });
            // Ativa todos os toasts ao carregar a página
            document.addEventListener('DOMContentLoaded', function() {
                var toastElList = [].slice.call(document.querySelectorAll('.toast'));
                toastElList.forEach(function(toastEl) {
                    var toast = new bootstrap.Toast(toastEl);
                    toast.show();
                });

                // Validação de formulário (mantém sua lógica)
                const form = document.getElementById('registerForm');
                const submitBtn = document.getElementById('submitBtn');
                if (form && submitBtn) {
                    form.addEventListener('input', function() {
                        let valid = true;
                        form.querySelectorAll('[required]').forEach(function(input) {
                            if (!input.value.trim()) valid = false;
                        });
                        submitBtn.disabled = !valid;
                    });
                }
            });
        </script>
    </main>
</body>
</html>